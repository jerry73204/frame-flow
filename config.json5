{
    "dataset": {
        "type": "simple",
        "dataset_dir": "/home/aeon/dataset/pcd-gen_output",
        "file_name_digits": 8,
    },
    // "dataset": {
    //     "type": "mnist",
    //     "dataset_dir": "/home/aeon/dataset/mnist",
    // },
    // "dataset": {
    //     "type": "iii",
    //     "dataset_dir": "/home/aeon/dataset/iii_small",
    //     "classes_file": "cfg/class/iii.class",
    //     "min_seq_len": 5,
    // },
    "model": {
        "detection_embedding": {
            "channels": [6],
            "num_blocks": [0],
        },
        "detector": {
            "model_file": "cfg/model/yolov4-csp-custom-64x64-2021-08-21.json5",
            "weights_file": "log-wayside-64x64-2021-08-22/2021-08-23-14-09-18.616+0800/checkpoints/detector_2021-08-23-17-09-43.119+0800_006200.ckpt",
        },
        "generator": {
            "kind": "Resnet",
            // "kind": "Custom",
            "norm": "BatchNorm",
            "weights_file": "log-wayside-64x64-2021-08-22/2021-08-23-14-09-18.616+0800/checkpoints/generator_2021-08-23-17-09-43.215+0800_006200.ckpt",
        },
        "discriminator": {
            "num_blocks": 6,
            "norm": "None",
            // "norm": "InstanceNorm",
            "weights_file": "log-wayside-64x64-2021-08-22/2021-08-23-14-09-18.616+0800/checkpoints/discriminator_2021-08-23-17-09-43.212+0800_006200.ckpt",
        },
        "transformer": {
            "norm": "BatchNorm",
            "num_input_detections": 3,
            "num_resnet_blocks": 1,
            "num_scaling_blocks": 3,
            "num_down_sample": 3,
            "weights_file": "log-wayside-64x64-2021-08-23/2021-08-23-17-22-34.546+0800/checkpoints/transformer_2021-08-24-08-58-17.004+0800_016100.ckpt",
        },
        "transformer_discriminator": {
            "num_blocks": 6,
            "norm": "None",
            "num_detections": 4,
            // "norm": "InstanceNorm",
            "weights_file": "log-wayside-64x64-2021-08-23/2021-08-23-17-22-34.546+0800/checkpoints/transformer_discriminator_2021-08-24-08-58-17.004+0800_016100.ckpt",
        },
    },
    "loss": {
        "detector": {
            "match_grid_method": "Rect4", // Rect2, Rect4
            "box_metric": "Hausdorff",    // IoU, GIoU, DIoU, CIoU, Hausdorff
            "objectness_loss_fn": "Bce",
            "classification_loss_fn": "Bce",
            "objectness_positive_weight": 1.0,

            // for DIoU
            // "iou_loss_weight": 0.31,
            // "objectness_loss_weight": 1.0,
            // "classification_loss_weight": 0.87,

            // for Hausdorff
            "iou_loss_weight": 55.0,
            "objectness_loss_weight": 1.0,
            "classification_loss_weight": 55.0,
        },
        "image_recon": "WGanGp",
        // "image_recon": "RaSGan",
    },
    "train": {
        "cache_dir": "/home/aeon/frame-flow-cache",
        // resnet
        "batch_size": 120,
        // unet
        // "batch_size": 20,
        "image_size": 64,
        "latent_dim": 256,
        "device": "cuda:0",
        "peek_len": 3,
        "pred_len": 1,
        "lr_schedule": {
            "type": "StepWise",
            "steps": [
                [0, 0.0001],
            ],
        },
        "warm_up_steps": 20,
        "label_flip_prob": 0,
        "critic_noise_prob": 0.5,
        "train_detector_steps": 0,
        "train_discriminator_steps": 0,
        "train_generator_steps": 0,
        "train_consistency_steps": 0,
        "train_transformer_steps": 1,
        "train_transformer_discriminator_steps": 5,
    },
    "logging": {
        // "log_dir": "log-test",
        "log_dir": "log-wayside-64x64-2021-08-23",
        "save_image_steps": 10,
        "save_checkpoint_steps": 100,
        "save_detector_checkpoint": false,
        "save_generator_checkpoint": false,
        "save_discriminator_checkpoint": false,
        "save_transformer_checkpoint": true,
        "save_transformer_discriminator_checkpoint": true,
    },
}
